<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UXPurificationRitual</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background: #000 url('https://www.transparenttextures.com/patterns/matrix.png') repeat;
  color: #00ff00;
  font-family: "Courier New", Courier, monospace;
  overflow-x: hidden;
}
.box {
  max-width: 480px;
  margin: 60px auto;
  background: rgba(0,0,0,0.85);
  border: 1px solid #00ff00;
  padding: 20px;
  text-align: center;
  box-shadow: 0 0 20px #00ff00;
}
.header { font-size: 12px; color: #66ff66; text-align: left; }
.badges { margin-top: 8px; font-size: 11px; color: #66ff66; }
.failure { font-size: 12px; color: #ff3333; margin-top: 6px; }
.ip { font-size: 12px; color: #ff3333; margin-top: 8px; }
.xp-bar-container { height: 18px; border: 1px solid #66ff66; background: #111; overflow: hidden; margin: 15px 0; }
.xp-bar { height: 100%; width: 40%; background: linear-gradient(90deg,#00ff00 25%,#66ff66 50%,#00ff00 75%); animation: move 1.2s linear infinite; }
@keyframes move { from { transform: translateX(-100%); } to { transform: translateX(350%); } }
.hidden { display:none; }
input[type="range"] { width: 100%; margin-top: 10px; }
input[type="text"] { width: 100%; margin-top: 10px; background: #000; color: #00ff00; border: 1px solid #00ff00; padding: 5px; }
button { margin-top: 10px; background: #000; color: #00ff00; border: 1px solid #00ff00; padding: 5px 10px; cursor: pointer; }
</style>
</head>
<body>

<audio id="errorSound">
  <source src="https://www.soundjay.com/button/sounds/button-10.mp3">
</audio>

<!-- STAGE 1 -->
<div class="box" id="stage1">
  <div class="header">Step 2 of 2</div>
  <h3>Checking your connection…</h3>
  <p>This process is automatic. Please wait while we verify your connection.</p>
  <div class="xp-bar-container"><div class="xp-bar"></div></div>
  <p id="s1">Analyzing behavior…</p>
  <div class="badges">
    ✓ Human Interaction Certified<br>
    ✓ WCAG-ish Compliant<br>
    ✓ Cloud Security Verified
  </div>
  <div class="failure">Failure rate: 92%</div>
  <div class="ip">IP reputation: LOW</div>
</div>

<!-- STAGE 2 -->
<div class="box hidden" id="stage2">
  <div class="header">Step 2 of 2</div>
  <h3>Slide to verify</h3>
  <input type="range" id="slider">
  <p id="s2">Almost…</p>
  <div class="badges">✓ Bot Detection Enabled</div>
  <div class="failure">Failure rate: 92%</div>
  <div class="ip">IP reputation: LOW</div>
</div>

<!-- STAGE 3 -->
<div class="box hidden" id="stage3">
  <div class="header">Step 2 of 2</div>
  <h3>Final verification</h3>
  <p id="question"></p>
  <input type="text" id="answer" placeholder="Enter answer…">
  <button onclick="submitMath()">Submit</button>
  <p id="s3"></p>
  <div class="failure">Failure rate: 92%</div>
  <div class="ip">IP reputation: LOW</div>
</div>

<script>
const errorSound = document.getElementById("errorSound");
let lastInteraction = Date.now();

/* ---------- INTERACTION PUNISHMENT ---------- */
["mousemove","keydown","mousedown","scroll","touchstart"]
.forEach(e => document.addEventListener(e, () => {
  lastInteraction = Date.now();
  errorSound.play();
}));

/* ---------- DEVTOOLS DETECTION ---------- */
setInterval(() => {
  if (window.outerWidth - window.innerWidth > 160 || window.outerHeight - window.innerHeight > 160) {
    location.reload();
  }
}, 500);

/* ---------- STAGE HANDLING ---------- */
const stage1 = document.getElementById("stage1");
const stage2 = document.getElementById("stage2");
const stage3 = document.getElementById("stage3");
const s1 = document.getElementById("s1");
const s2 = document.getElementById("s2");
const s3 = document.getElementById("s3");
const slider = document.getElementById("slider");
let currentStage = 1;

/* Stage 1 XP bar creep (90-120 sec) */
let stage1Duration = 90000 + Math.random()*30000;
setTimeout(goStage2, stage1Duration);

/* Optional: slowly creep XP bar visually */
let xpProgress = 0;
let xpInterval = setInterval(()=>{
  xpProgress += Math.random()*0.8; // slow random increment
  if(xpProgress>99) xpProgress=99;
  document.querySelector(".xp-bar").style.width = xpProgress + "%";
},1000);

/* ---------- STAGE 2: Smooth resistive slider ---------- */
const sliderPassChance = 0.02; // 2% chance to pass

slider.addEventListener("input", () => {
  let current = parseFloat(slider.value);

  // resistance stronger near end
  let resistance = Math.max(0.2, 1 - current / 100);
  let pushback = Math.random() * 5 * resistance;

  // Animate back smoothly
  let steps = 10, i=0;
  let step = pushback/steps;
  let anim = setInterval(()=>{
    if(i++>=steps){ clearInterval(anim); return; }
    slider.value = Math.max(0, parseFloat(slider.value)-step);
  },20);

  const msgs = ["So close…","Try again…","Almost…","Keep sliding…","Just a bit more…"];
  s2.innerText = msgs[Math.floor(Math.random()*msgs.length)];
  errorSound.play();

  if(Math.random()<sliderPassChance){
    stage2.classList.add("hidden");
    stage3.classList.remove("hidden");
    initStage3();
  }
});

/* ---------- STAGE 3: Random math gaslight ---------- */
let gaslightIndex = 0;
let num1,num2;
const gaslightMsgs=["Correct. Previously.","Correct. Previously.","Correct. Previously…","Correct. Previously…","Correct. Previously..."];

function initStage3(){
  gaslightIndex=0;
  num1 = Math.floor(Math.random()*20)+1;
  num2 = Math.floor(Math.random()*20)+1;
  question.innerText=`What is ${num1} + ${num2}?`;
  s3.innerText="Enter your answer:";
  document.getElementById("answer").value="";
  currentStage=3;
}

function submitMath(){
  const val = document.getElementById("answer").value.trim();
  const correct = num1 + num2;

  if(parseInt(val)===correct && gaslightIndex<gaslightMsgs.length){
    s3.innerText = gaslightMsgs[gaslightIndex];
    gaslightIndex++;
    document.getElementById("answer").value="";
    errorSound.play();
    return;
  }

  s3.innerText="Verification accepted. Redirecting…";
  errorSound.play();
  setTimeout(()=>window.location.href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&redirect_back=true",7000);
}

/* ---------- STAGE TRANSITIONS ---------- */
function goStage2(){
  stage1.classList.add("hidden");
  stage2.classList.remove("hidden");
  s2.innerText="Almost…";
  currentStage=2;
}

function goStage3(){
  stage2.classList.add("hidden");
  stage3.classList.remove("hidden");
  initStage3();
}

/* Optional backward jumps */
setInterval(()=>{
  if(Math.random()<0.15){
    if(currentStage===2){
      stage2.classList.add("hidden");
      stage1.classList.remove("hidden");
      s1.innerText="Oops… rechecking data…";
      currentStage=1;
    }else if(currentStage===3){
      stage3.classList.add("hidden");
      stage2.classList.remove("hidden");
      s2.innerText="Something went wrong… try sliding again…";
      currentStage=2;
    }
  }
},10000);

/* ---------- LOOP BACK AFTER RICKROLL ---------- */
if(document.referrer.includes("youtube.com")){
  setTimeout(()=>location.reload(),1000);
}
</script>

</body>
</html>